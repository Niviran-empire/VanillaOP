#	|VOP新增/VOP优化|	同步追踪|3.14.159	\events\on_action_events_1.txt		action.64/action.85/action.90/
namespace = action


# Assimilate Pops on Yearly Pulse

# Planets in mixed-ownership systems fall to starbase owner
event = {#_|VOP优化|修改trigger
	id = action.85
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		any_country = {
			OR = {#_|VOP优化|从|非原始|改为|普通+堕落|
				is_country_type = default
				is_country_type = fallen_empire
				is_country_type = awakened_fallen_empire
			}
			any_owned_planet = {
				exists = starbase
				starbase = { owner = { NOR = { is_same_value = prevprevprev	is_at_war_with = prevprevprev } } }
			}
		}
	}

	immediate = {
		every_galaxy_planet = {
			limit = {
				exists = owner
				owner = {
					OR = {
						is_country_type = default
						is_country_type = fallen_empire
						is_country_type = awakened_fallen_empire
					}
				}
				exists = starbase
				starbase = {
					exists = owner
					owner = {
						OR = {
							is_country_type = default
							is_country_type = fallen_empire
							is_country_type = awakened_fallen_empire
						}
						NOR = {
							is_same_value = prevprev.owner
							is_at_war_with = prevprev.owner
						}
						NOT = {
							has_active_event = {
								preftl.180 #event to decide fate of pre-ftl civ
							}
						}
					}
				}
			}
			planet_event = { id = action.86 } # planet flips to starbase owner
		}
	}
}

namespace = pirate
# Pirates Sighted On Action
event = {
	id = pirate.48
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		any_country = {
			has_country_flag = birth_of_piracy
			NOT = { has_country_flag = pirates_spawned }
			any_system_within_border = {
				any_system_planet = {
					planet_resource_compare = {
						resource = trade
						value > 100
					}
				}
			}
		}
	}

	immediate = {
		every_playable_country = {
			limit = {
				has_country_flag = birth_of_piracy
				NOT = { has_country_flag = pirates_spawned }
				any_system_within_border = {
					any_system_planet = {
						planet_resource_compare = {
							resource = trade
							value > 100
						}
					}
				}
			}
			country_event = { id = pirate.49 }
		}
	}
}

event = {
	id = pirate.4
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		any_country = {
			NOT = { has_country_flag = birth_of_piracy }
			has_monthly_income = {
				resource = trade
				value > 100
			}
		}
	}

	immediate = {
		every_playable_country = {
			limit = {
				NOT = { has_country_flag = birth_of_piracy }
				has_monthly_income = {
					resource = trade
					value > 100
				}
			}
			country_event = { id = pirate.5 }
		}
	}
}