#	|VOP新增/VOP优化|	同步追踪|3.14.159	\events\paragon_events_1.txt	paragon.405
namespace = paragon


# on_tradition_picked "tr_statecraft_inspiring_agendas", show a notification that they're available.
country_event = {#_|VOP优化|添加trigger修改effect
	id = paragon.405
	hide_window = yes
	is_triggered_only = yes

	trigger = {# |VOP优化|trigger转入
		has_tradition = tr_statecraft_inspiring_agendas
		NOT = { has_country_flag = has_picked_tr_statecraft_inspiring_agendas }
	}

	immediate = {# |VOP优化|trigger转出
		# Makes sure this is only triggered ONCE and only when tr_statecraft_inspiring_agendas was unlocked.
		set_country_flag = has_picked_tr_statecraft_inspiring_agendas

		create_message = {
			type = COUNCIL_AGENDA_AVAILABLE
			localization = MESSAGE_COUNCIL_AGENDA_AVAILABLE_UNLOCKED_INSPIRING_AGENDAS
			days = 30
			# Unfortunately can't set message type to: _MESSAGE_TYPE_COUNCIL_AGENDA_READY_, which would enable Left-click to open Council.
		}
	}
}

# on_agenda_finished "Superior Colonies", check for young Colonies that should get the boost modifier.
country_event = {#_|VOP优化|添加trigger修改effect
	id = paragon.404
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_ai = no
		OR = {
			has_modifier = agenda_superior_colonies_finish
			has_modifier = agenda_superior_colonies_finish_wilderness
		}
	}

	immediate = {
		if = {
			# Not necessarily the last finished Agenda, but checking if it's active does the job.
			limit = {
				owner = {
					OR = {
						has_modifier = agenda_superior_colonies_finish
						has_modifier = agenda_superior_colonies_finish_wilderness
					}
				}
			}
			# Check all our Colonies if they were founded last 10 years (has can_be_boosted flag).
			every_system_within_border = {
				every_system_planet = {
					limit = {
						is_colony = yes
						is_owned_by = root.owner
						has_planet_flag = superior_colonies_can_be_boosted
					}
					remove_planet_flag = superior_colonies_can_be_boosted
					add_modifier = {
						modifier = agenda_superior_colonies_planet_boost
						days = @agenda_finish_modifier_duration
					}
				}
			}
		}
	}
}