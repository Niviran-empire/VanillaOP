################################
#
# Archaeology Site Spawn Event
#
###############################

namespace = ancrel

# Archaeology Site On Survey Spawn
ship_event = {
	id = ancrel.9999
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		FROM = {
			NOR = {
				exists = archaeological_site
				has_planet_flag = suppress_archaeological_sites
				solar_system = { OR = {
					has_star_flag = suppress_archaeological_sites
					kuat_is_kuat_system = yes
					has_star_flag = myst_system_5
					has_star_flag = myst_system_4
					has_star_flag = myst_system_3
					has_star_flag = myst_system_2
					has_star_flag = myst_system_1
				} }
				has_deposit = d_trade_value_1 #Not very clean, but trade value deposits are weird and will block minor artifact deposits.
				has_deposit = d_trade_value_2
				has_deposit = d_trade_value_3
				has_deposit = d_trade_value_4
				has_deposit = d_trade_value_5
				has_deposit = d_trade_value_6
				has_deposit = d_trade_value_7
				has_deposit = d_trade_value_8
				has_deposit = d_trade_value_9
				has_deposit = d_trade_value_10
			}
		}
	}

	immediate = {
		random_list = {
			400 = {
				modifier = {
					factor = 5
					OR = {
						owner = { has_country_flag = discovered_site }
						owner = { has_country_flag = discovered_site_cooldown }
					}
				}
			}
			1 = {
				modifier = {
					factor = 0.1
					OR = {
						owner = { is_ai = yes }
						owner = { has_country_flag = discovered_site }
						owner = { has_country_flag = discovered_site_cooldown }
					}
				}
				from = {
					prevent_anomaly = yes
					create_archaeological_site = random
				}
				owner = { set_timed_country_flag = { flag = discovered_site_cooldown days = 1440 } }
				if = { #Not all celestial bodies can have arc sites
					limit = { exists = from.archaeological_site }
					owner = { set_timed_country_flag = { flag = discovered_site days = 1440 } }
				}
			}
		}
	}
}