################################
#
# Origin Events
# Written and Modded by Eddy
#
###############################
namespace = vop_ai_fixed
# event = {
# 	id = vop_ai_fixed.1
# 	hide_window = yes
# 	is_triggered_only = yes
# 	immediate = { 
# 		set_global_flag = VOP_MOD_INSTALL
# 		#set_global_flag = force_disable_aow_megastructure
# 		set_global_flag = force_adjust_aow_megastructure_cap
# 	}
# }

@noxious_happiness_penalty = -0.01
@pop_happiness_unemply_rate = 0.10
event = {
	id = vop_ai_fixed.5
	hide_window = yes
	is_triggered_only = yes
	trigger = { 
		NOT = { has_global_flag = VOP_CD_vop_ai_fixed }
		count_playable_country = { count > 0 } 
	}
	immediate = {
		set_global_flag = VOP_flg_glbl_AP_no_ai
		set_timed_global_flag = { flag = VOP_CD_vop_ai_fixed days = 1 }
		vop_optimaze_action_116 = yes # action.116
		vop_optimaze_game_rule_system_sensor = yes #sensor gamerule
		vop_optimaze_action_90 = yes # action 90
		# country_event tech
		every_country = {
			vop_optimaze_war_goals = yes # warcb
			vop_optimaze_enclave_2065 = yes # enclave 2065
			if = {
				limit = { 
					is_ai = yes 
					OR = {
						is_country_type = fallen_empire
						is_country_type = awakened_fallen_empire
						is_country_type = default
						is_country_type = enclave_mercenary
					}
					OR = {
						has_existing_ship_design = battleship
						has_existing_ship_design = large_ship_fallen_empire
					}
				}
				vop_optimaze_event_country_ships = { Ship_Size = frigate Count = 20 } #ship op
				vop_optimaze_event_country_ships = { Ship_Size = corvette Count = 20 } #ship op
				vop_optimaze_event_country_ships = { Ship_Size = destroyer Count = 15 } #ship op
				vop_optimaze_event_country_ships = { Ship_Size = cruiser Count = 10 } #ship op
				vop_optimaze_event_country_ships = { Ship_Size = small_ship_fallen_empire Count = 10 } #ship op
			}
			if = {
				limit = { NOT = { has_modifier = str_ground_battle }  }
				add_modifier = { modifier = str_ground_battle } 
			}
			vop_optimaze_tech_caculation = yes #TECH OP
		}
		vop_optimaze_event_pop_caculation = yes # pop events
		vop_optimaze_event_species_caculation = yes #spciese event
		vop_optimaze_event_planet_caculation = yes # planet events
	}
}
event = {
	id = vop_ai_fixed.6
	hide_window = yes
	is_triggered_only = yes
	trigger = { 
		NOT = { has_global_flag = VOP_CD_vop_ai_fixed }
		count_playable_country = { count > 0 } 
	}
	immediate = {
		set_global_flag = VOP_flg_glbl_AP_no_ai
		set_timed_global_flag = { flag = VOP_CD_vop_ai_fixed days = 1 }
		set_update_modifiers_batch = begin
		vop_optimaze_action_116 = yes # action.116
		vop_optimaze_game_rule_system_sensor = yes #sensor gamerule
		vop_optimaze_action_90 = yes # action 90
		# country_event tech
		every_country = {
			vop_optimaze_war_goals = yes # warcb
			vop_optimaze_enclave_2065 = yes # enclave 2065
			if = {
				limit = { 
					is_ai = yes 
					OR = {
						AND = {
							has_technology = tech_battleships
							OR = {
								is_country_type = default
								is_country_type = enclave_mercenary
							}
						}
						AND = {
							has_existing_ship_design = large_ship_fallen_empire
							is_fallen_empire = yes
						}
					}
				}
				vop_optimaze_event_country_ships = { Ship_Size = frigate Count = 20 } #ship op
				vop_optimaze_event_country_ships = { Ship_Size = corvette Count = 20 } #ship op
				vop_optimaze_event_country_ships = { Ship_Size = destroyer Count = 15 } #ship op
				vop_optimaze_event_country_ships = { Ship_Size = cruiser Count = 10 } #ship op
				vop_optimaze_event_country_ships = { Ship_Size = small_ship_fallen_empire Count = 10 } #ship op
			}
			if = {
				limit = { NOT = { has_modifier = str_ground_battle }  }
				add_modifier = { modifier = str_ground_battle } 
			}
			vop_optimaze_tech_caculation = yes #TECH OP
		}
		vop_optimaze_event_pop_caculation = yes # pop events
		vop_optimaze_event_species_caculation = yes #spciese event
		vop_optimaze_event_planet_caculation = yes # planet events
		set_update_modifiers_batch = end
	}
}
country_event = {
	id = vop_ai_fixed.26
	hide_window = yes
	is_triggered_only = yes
	trigger = { 
		is_ai = yes
		check_variable_arithmetic = { which = modifier:country_resource_max_add value >= 100000 }
		OR = {
			resource_stockpile_compare = { resource = energy value > modifier:country_resource_max_add }
			resource_stockpile_compare = { resource = food value > modifier:country_resource_max_add }
			resource_stockpile_compare = { resource = minerals value > modifier:country_resource_max_add }
		}
	}
	immediate = { 
		VOP_ai_REROURCE_opt = { TYPE = energy MULT = 0.5 }
		VOP_ai_REROURCE_opt = { TYPE = food MULT = 0.5 }
		VOP_ai_REROURCE_opt = { TYPE = minerals MULT = 0.5 }
	}
}